<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Diagnostic Flash RGAA</title>
  <link rel="stylesheet" href="panel.css">
</head>
<body>
  <div class="container">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
      <h1 style="margin: 0; display: flex; align-items: center; gap: 8px;">
        <span id="header-icon" style="display: flex; align-items: center;"></span>
        Diagnostic Flash RGAA
      </h1>
      <span id="version-display" style="font-size: 11px; color: var(--color-text-tertiary); font-weight: normal;">v<span id="version-number">-</span></span>
    </div>
    
    <!-- Onglets -->
    <div class="tabs">
      <ul class="tabs-list">
        <li class="tab-item">
          <button class="tab-button active" data-tab="audit">Audit</button>
        </li>
        <li class="tab-item">
          <button class="tab-button" data-tab="scores">Scores</button>
        </li>
        <li class="tab-item">
          <button class="tab-button" data-tab="informations">Informations</button>
        </li>
      </ul>
    </div>
    
    <!-- Onglet Audit -->
    <div class="tab-content active" id="tab-audit">
      <div class="stats" id="stats">
        <div class="stat">
          <div class="stat-row">
            <div class="stat-icon" id="stat-icon-total"></div>
            <div class="stat-value" id="totalTests">0</div>
          </div>
          <div class="stat-label" data-i18n="statsTotal">Total</div>
        </div>
        <div class="stat">
          <div class="stat-row">
            <div class="stat-icon" id="stat-icon-passed"></div>
            <div class="stat-value" id="passedTests" style="color: var(--color-success);">0</div>
          </div>
          <div class="stat-label" data-i18n="statsPassed">Réussis</div>
        </div>
        <div class="stat">
          <div class="stat-row">
            <div class="stat-icon" id="stat-icon-failed"></div>
            <div class="stat-value" id="failedTests" style="color: var(--color-error);">0</div>
          </div>
          <div class="stat-label" data-i18n="statsFailed">Échoués</div>
        </div>
        <div class="stat">
          <div class="stat-row">
            <div class="stat-icon" id="stat-icon-not-applicable"></div>
            <div class="stat-value" id="notApplicableTests" style="color: var(--color-not-applicable);">0</div>
          </div>
          <div class="stat-label" data-i18n="statsNotApplicable">Non applicables</div>
        </div>
        <div class="stat">
          <div class="stat-row">
            <div class="stat-icon" id="stat-icon-score"></div>
            <div class="stat-value" id="scoreValue" style="color: var(--color-primary); font-size: 24px; font-weight: bold;">0</div>
          </div>
          <div class="stat-label" data-i18n="statsScore">Score / 100</div>
        </div>
      </div>
      
      <button class="button secondary" id="resetBtn" style="margin-bottom: 20px;" data-i18n="statsReset">Réinitialiser tous les tests</button>
      
      <div class="categories" id="categories">
        <div class="category" data-category="navigation">
          <div class="category-header" data-category-toggle="navigation">
            <span>
              <span class="category-icon" id="category-icon-navigation"></span>
              <span data-i18n="categoryNavigation">Navigation & utilisation</span>
            </span>
            <span class="category-arrow">▶</span>
          </div>
          <div class="category-content" id="category-navigation">
            <div class="empty-state" data-i18n="emptyState">Aucun test effectué pour cette catégorie</div>
          </div>
        </div>
        
        <div class="category" data-category="langage">
          <div class="category-header" data-category-toggle="langage">
            <span>
              <span class="category-icon" id="category-icon-langage"></span>
              <span data-i18n="categoryLangage">Langage & interface</span>
            </span>
            <span class="category-arrow">▶</span>
          </div>
          <div class="category-content" id="category-langage">
            <div class="empty-state" data-i18n="emptyState">Aucun test effectué pour cette catégorie</div>
          </div>
        </div>
        
        <div class="category" data-category="structuration">
          <div class="category-header" data-category-toggle="structuration">
            <span>
              <span class="category-icon" id="category-icon-structuration"></span>
              <span data-i18n="categoryStructuration">Structuration de l'information</span>
            </span>
            <span class="category-arrow">▶</span>
          </div>
          <div class="category-content" id="category-structuration">
            <div class="empty-state" data-i18n="emptyState">Aucun test effectué pour cette catégorie</div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Onglet Scores -->
    <div class="tab-content" id="tab-scores">
      <div class="stats" id="stats-scores" style="position: relative;">
        <div class="stat">
          <div class="stat-row">
            <div class="stat-icon" id="stat-icon-total-scores"></div>
            <div class="stat-value" id="totalTestsScores">0</div>
          </div>
          <div class="stat-label" data-i18n="statsTotal">Total</div>
        </div>
        <div class="stat">
          <div class="stat-row">
            <div class="stat-icon" id="stat-icon-passed-scores"></div>
            <div class="stat-value" id="passedTestsScores" style="color: var(--color-success);">0</div>
          </div>
          <div class="stat-label" data-i18n="statsPassed">Réussis</div>
        </div>
        <div class="stat">
          <div class="stat-row">
            <div class="stat-icon" id="stat-icon-failed-scores"></div>
            <div class="stat-value" id="failedTestsScores" style="color: var(--color-error);">0</div>
          </div>
          <div class="stat-label" data-i18n="statsFailed">Échoués</div>
        </div>
        <div class="stat">
          <div class="stat-row">
            <div class="stat-icon" id="stat-icon-not-applicable-scores"></div>
            <div class="stat-value" id="notApplicableTestsScores" style="color: var(--color-not-applicable);">0</div>
          </div>
          <div class="stat-label" data-i18n="statsNotApplicable">Non applicables</div>
        </div>
        <div class="stat">
          <div class="stat-row">
            <div class="stat-icon" id="stat-icon-score-scores"></div>
            <div class="stat-value" id="scoreValueScores" style="color: var(--color-primary); font-size: 24px; font-weight: bold;">0</div>
          </div>
          <div class="stat-label" data-i18n="statsScore">Score / 100</div>
        </div>
        <button class="button-small" id="downloadStatsBtn" style="position: absolute; top: 0; right: 0; font-size: 18px; padding: 8px 12px; line-height: 1; display: flex; align-items: center; justify-content: center; min-width: 40px; min-height: 40px;" title="Télécharger les statistiques (PNG transparent)" aria-label="Télécharger la grille de statistiques au format PNG transparent"></button>
      </div>
      
      <div class="pie-chart-container" style="margin-bottom: 15px; padding: 15px; background: var(--color-bg-tertiary); border-radius: 4px; text-align: center;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
          <div style="font-size: 13px; font-weight: 600;" data-i18n="statsDistribution">Répartition des résultats</div>
          <div style="display: flex; gap: 8px; align-items: center;">
            <button class="button-small" id="downloadChartBtn" style="font-size: 18px; padding: 8px 12px; line-height: 1; display: flex; align-items: center; justify-content: center; min-width: 40px; min-height: 40px;" title="Télécharger (PNG transparent)" aria-label="Télécharger le diagramme au format PNG transparent"></button>
          </div>
        </div>
        <svg id="pieChart" width="200" height="200" style="display: block; margin: 0 auto;">
          <circle cx="100" cy="100" r="80" fill="#e0e0e0" stroke="#fff" stroke-width="2"/>
        </svg>
        <div id="pieChartLegend" style="display: flex; justify-content: center; gap: 15px; margin-top: 10px; flex-wrap: wrap; font-size: 11px;">
          <!-- Légende générée dynamiquement -->
        </div>
      </div>
      
      <div id="summary-table-container" style="margin-bottom: 20px; overflow-x: auto;"></div>
    </div>
    
    <!-- Onglet Informations -->
    <div class="tab-content" id="tab-informations">
      <div class="info-content">
        <section class="info-section">
          <h2 class="info-title">Qu'est-ce que le diagnostic flash ?</h2>
          <p class="info-text">
            Le <strong>diagnostic flash</strong> permet d'estimer de manière <strong>rapide et partielle</strong> l'accessibilité d'un site ou d'un service en ligne, sans avoir d'expertise particulière.
          </p>
          <p class="info-text">
            Il est inutile de faire un audit de conformité au RGAA (Référentiel général d'amélioration de l'accessibilité) tant que tous ces critères ne sont pas respectés.
          </p>
        </section>
        
        <section class="info-section">
          <h2 class="info-title">Les trois thématiques</h2>
          
          <div class="info-theme">
            <h3 class="info-theme-title">
              <span class="category-icon" id="category-icon-info-navigation"></span>
              Navigation & utilisation
            </h3>
            <p class="info-text">
              Cette thématique vérifie que le site est utilisable par tous, indépendamment du dispositif ou de la méthode de navigation. Elle couvre :
            </p>
            <ul class="info-list">
              <li>L'adaptation à toutes les tailles d'écran (responsive design)</li>
              <li>La navigation au clavier et la visibilité du focus</li>
              <li>La présence de plusieurs moyens de navigation</li>
              <li>L'accessibilité des fichiers téléchargeables</li>
            </ul>
            <p class="info-text">
              <strong>Pourquoi ?</strong> Pour garantir que tous les utilisateurs, y compris ceux utilisant des aides techniques (lecteurs d'écran, navigation au clavier), puissent accéder et utiliser le site efficacement.
            </p>
          </div>
          
          <div class="info-theme">
            <h3 class="info-theme-title">
              <span class="category-icon" id="category-icon-info-langage"></span>
              Langage & interface
            </h3>
            <p class="info-text">
              Cette thématique s'assure que les contenus sont compréhensibles et utilisables par tous. Elle vérifie :
            </p>
            <ul class="info-list">
              <li>Les contrastes de couleurs (texte et éléments interactifs)</li>
              <li>L'information par la couleur (non exclusive)</li>
              <li>Les alternatives textuelles pour les médias (images, vidéos, audio)</li>
              <li>La définition de la langue principale</li>
              <li>La clarté des liens</li>
              <li>La possibilité d'agrandir le texte jusqu'à 200%</li>
              <li>Le contrôle des animations et sons</li>
            </ul>
            <p class="info-text">
              <strong>Pourquoi ?</strong> Pour permettre à tous les utilisateurs de percevoir, comprendre et interagir avec les contenus, quelles que soient leurs capacités visuelles, auditives ou cognitives.
            </p>
          </div>
          
          <div class="info-theme">
            <h3 class="info-theme-title">
              <span class="category-icon" id="category-icon-info-structuration"></span>
              Structuration de l'information
            </h3>
            <p class="info-text">
              Cette thématique vérifie que l'information est bien organisée et structurée. Elle contrôle :
            </p>
            <ul class="info-list">
              <li>L'unicité et la pertinence du titre de page</li>
              <li>La hiérarchie complète et cohérente des titres (H1, H2, H3...)</li>
              <li>L'association claire des champs de formulaire avec leurs intitulés</li>
              <li>Les informations relatives aux fichiers téléchargeables (format, taille, langue)</li>
            </ul>
            <p class="info-text">
              <strong>Pourquoi ?</strong> Pour permettre une navigation efficace et une compréhension claire de la structure du contenu, notamment pour les utilisateurs de lecteurs d'écran qui naviguent de titre en titre.
            </p>
          </div>
        </section>
        
        <section class="info-section">
          <h2 class="info-title">Diagnostic flash vs Audit RGAA complet</h2>
          
          <div class="info-comparison">
            <div class="info-comparison-item">
              <h3 class="info-comparison-title">Diagnostic flash</h3>
              <ul class="info-list">
                <li><strong>Objectif</strong> : Estimation rapide et partielle</li>
                <li><strong>Durée</strong> : Quelques minutes</li>
                <li><strong>Expertise requise</strong> : Aucune</li>
                <li><strong>Critères</strong> : 15 critères essentiels</li>
                <li><strong>Thématiques</strong> : 3 thématiques principales</li>
                <li><strong>Usage</strong> : Point de départ, vérification rapide</li>
              </ul>
            </div>
            
            <div class="info-comparison-item">
              <h3 class="info-comparison-title">Audit RGAA complet</h3>
              <ul class="info-list">
                <li><strong>Objectif</strong> : Conformité complète et exhaustive</li>
                <li><strong>Durée</strong> : Plusieurs jours/semaines</li>
                <li><strong>Expertise requise</strong> : Expertise en accessibilité</li>
                <li><strong>Critères</strong> : 106 critères (RGAA 4.1)</li>
                <li><strong>Thématiques</strong> : 13 thématiques complètes</li>
                <li><strong>Usage</strong> : Conformité légale, déclaration d'accessibilité</li>
              </ul>
            </div>
          </div>
          
          <div class="info-highlight">
            <p class="info-text">
              <strong>Important</strong> : Le diagnostic flash est une recommandation. Il est recommandé de réaliser un diagnostic flash avant de procéder à un audit RGAA complet.
            </p>
            <p class="info-text">
              Le diagnostic flash couvre les critères les plus fondamentaux et les plus fréquemment problématiques. Une fois ces critères respectés, vous pouvez procéder à un audit complet pour vérifier la conformité à l'ensemble du référentiel RGAA.
            </p>
          </div>
        </section>
        
        <section class="info-section">
          <h2 class="info-title">Extensions recommandées</h2>
          <p class="info-text">
            Pour réaliser un diagnostic flash complet, il est recommandé d'utiliser également ces extensions de navigateur :
          </p>
          <ul class="info-list">
            <li>
              <strong>HeadingsMap</strong> (pictogramme [h/]) : Pour vérifier la hiérarchie des titres
              <br>
              <span class="info-link">Disponible pour Chrome, Firefox et Edge</span>
            </li>
            <li>
              <strong>Contrast Checker</strong> (roue multicolore) : Pour vérifier les contrastes de couleurs
              <br>
              <span class="info-link">Disponible pour Chrome, Firefox et Edge</span>
            </li>
          </ul>
          <div class="info-highlight" style="margin-top: 15px;">
            <p class="info-text">
              <strong>Note</strong> : Cette extension intègre certaines fonctionnalités (en beta) de ces plugins recommandés. Cependant, les extensions HeadingsMap et Contrast Checker restent la recommandation officielle des concepteurs du Diagnostic flash et sont à privilégier pour un diagnostic complet.
            </p>
          </div>
        </section>
        
        <section class="info-section">
          <h2 class="info-title">Référence</h2>
          <p class="info-text">
            Cette extension est basée sur le référentiel du diagnostic flash disponible sur :
            <br>
            <a href="https://design.numerique.gouv.fr/outils/diagnostic-flash/" target="_blank" rel="noopener noreferrer" class="info-external-link">
              design.numerique.gouv.fr/outils/diagnostic-flash/
            </a>
          </p>
        </section>
      </div>
    </div>
  </div>
  
  <!-- Popin modal -->
  <div class="popin-overlay" id="popin-overlay">
    <div class="popin-modal">
      <div class="popin-header">
        <span id="popin-title">Instructions</span>
        <button class="popin-close" id="popin-close" aria-label="Fermer">×</button>
      </div>
      <div class="popin-body" id="popin-body"></div>
      <div class="popin-footer">
        <button class="button-small" id="popin-ok">OK</button>
      </div>
    </div>
  </div>
  
  <!-- Modules utilitaires -->
  <script src="utils/i18n.js"></script>
  <script src="utils/icons.js"></script>
  <script src="utils/cleanup.js"></script>
  <script src="utils/stats.js"></script>
  <script src="utils/ui.js"></script>
  
  <!-- Visualisations Navigation -->
  <script src="tests/navigation/keyboard-visualization.js"></script>
  
  <!-- Modules contrastes (dans l'ordre de dépendance) -->
  <script src="tests/langage/contrasts/utils.js"></script>
  <script src="tests/langage/contrasts/analyze.js"></script>
  <script src="tests/langage/contrasts/display.js"></script>
  <script src="tests/langage/contrasts/highlight.js"></script>
  <script src="tests/langage/contrasts/observer.js"></script>
  
  <!-- Tests Navigation & utilisation -->
  <script src="tests/navigation/responsive-design.js"></script>
  <script src="tests/navigation/keyboard-navigation.js"></script>
  <script src="tests/navigation/two-navigation-means.js"></script>
  <script src="tests/navigation/downloadable-files.js"></script>

  <!-- Tests Langage & interface -->
  <script src="tests/langage/contrasts.js"></script>
  <script src="tests/langage/color-only.js"></script>
  <script src="tests/langage/media-alternatives-visualization.js"></script>
  <script src="tests/langage/media-alternatives.js"></script>
  <script src="tests/langage/language-defined.js"></script>
  <script src="tests/langage/explicit-links.js"></script>
  <script src="tests/langage/text-resize.js"></script>
  <script src="tests/langage/animations.js"></script>

  <!-- Tests Structuration de l'information -->
  <script src="tests/structuration/page-title.js"></script>
  <script src="tests/structuration/headings-hierarchy/analyze.js"></script>
  <script src="tests/structuration/headings-hierarchy/display.js"></script>
  <script src="tests/structuration/headings-hierarchy.js"></script>
  <script src="tests/structuration/form-fields-visualization.js"></script>
  <script src="tests/structuration/form-fields.js"></script>
  <script src="tests/structuration/download-info.js"></script>
  
  <!-- Fichier principal -->
  <script src="panel.js"></script>
</body>
</html>